<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Vuex 学习总结</title>
    <meta name="description" content=",江矿,江矿宝宝,joname,joname.liangtan,前端,伪前端,前台端菜,js,jquery,javascript,开发者,攻城狮,码农,挖煤,挖矿,煤厂,矿厂,极客,编程,代码,开源,IT网站,Developer,Programmer,Coder,Geek,html,html5,css,css3,Front-end,Front-end Developer,FE,FEer" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="../assets/favicon.png?v=3fe33f358e">
    <link href="../assets/css/all.min.css?v=3fe33f358e" rel="stylesheet">
    <link href="https://fonts.css.network/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" rel="stylesheet">
    <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/prism/1.6.0/themes/prism.css" rel="stylesheet">
</head>

<body class="post-template nav-closed">
    
    <div class="site-wrapper">
            <header class="main-header post-head no-cover">
        <nav class="main-nav  clearfix">
            <a class="home-button" href="../index.html">Home</a>
            
        </nav>
    </header>
    <main class="content" role="main">
        <article class="post">
            <header class="post-header">
                <h1 class="post-title">Vuex 学习总结</h1>
                <section class="post-meta">
                    <time class="post-date">15 Jul 2017</time>
                    <!-- "" -->
                </section>
            </header>
            <section class="post-content">
                <p>对于很多新手来说，只是阅读文档是不好消化，我的建议是看看 vuex 的实例，通过研究实例来学习vuex。这样就会好理解多了。如果还是不能理解，最好办法就是先把store 的四个属性：state， getters, mutations, actions 记下来，然后再分析四个属性的特点，什么地方会用到，是怎样连接在一起的？通过这样问自己问题来进行学习。</p>

<p>简单来说，vuex 就是使用一个 store 对象来包含所有的应用层级状态，也就是数据的来源。当然如果应用比较庞大，我们可以将 store 模块化，也就是每个模块都有自己的 store。一个 store 有四个属性：state, getters, mutations, actions。</p>

<h4 id="1state">1、State</h4>

<p>state 上存放的，说的简单一些就是变量，也就是所谓的状态。没有使用 state 的时候，我们都是直接在 data 中进行初始化的，但是有了 state 之后，我们就把 data 上的数据转移到 state 上去了。当一个组件需要获取多个状态时候，将这些状态都声明为计算属性会有些重复和冗余。为了解决这个问题，我们可以使用 mapState 辅助函数帮助我们生成计算属性，让你少按几次键：</p>

<p>其实就是把 state 上保存的变量转移到计算属性上。当映射的计算属性的名称与 state 的子节点名称相同时，我们也可以给 mapState 传一个字符串数组。</p>

<pre><code class="language-js">computed: mapState([  
  // 映射 this.count 为 store.state.count
  'count'
])
</code></pre>

<p>为了更好地理解这个函数的作用，我们可以看看它的源代码。
可以看到，mapstate 即可以接受对象，也可以接受数组。最终返回的是一个对象。并且 res[key] 的值都是来于 store 里的，红色那条代码就是。这样就把两个不相关的属性连接起来了,这也是映射。其他几个辅助函数也是类似的。</p>

<h4 id="2getters">2、Getters</h4>

<p>getters上简单来说就是存放一些公共函数供组件调用。getters 会暴露为 store.getters 对象，也就是说可以通过 store .getters[属性]来进行相应的调用。mapGetters 辅助函数仅仅是将 store 中的 getters 映射到局部计算属性，其实也就是从 getters 中获取对应的属性，跟解构类似。具体如下图这样我们就可以将 getters 中的 evenOrOdd 属性值传给对应组件中的 evenOrOdd 上。Getters 接受 state 作为其第一个参数，Getters 也可以接受其他 getters 作为第二个参数。</p>

<h4 id="3mutations">3、Mutations</h4>

<p>mutations 与事件类似，更改 Vuex 的 store 中的状态的唯一方法是提交 mutation。所以 mutations 上存放的一般就是我们要改变 state 的一些方法。</p>

<pre><code class="language-js">const store = new Vuex.Store({  
  state: {
    count: 1
  },
  mutations: {
    increment (state) {
      // 变更状态
      state.count++
    }
  }
})
</code></pre>

<p>我们不能直接调用一个 mutation handler。 这个选项更像是事件注册 ：“当触发一个类型为 increment 的 mutation 时，调用此函数 。”要唤醒一个 mutation handler，你需要以相应的 type 调用 store.commit 方法：</p>

<pre><code class="language-js">store.commit('increment')  
</code></pre>

<p>当 mutation 事件类型比较多的时候，我们可以使用常量替代 mutation 事件类型。同时把这些常量放在单独的文件中可以让我们的代码合作者对整个 app 包含的 mutation 一目了然：
一条重要的原则就是要记住 mutation 必须是同步函数 。</p>

<h4 id="4actions">4、Actions</h4>

<p>前面说了， mutation 像事件注册，需要相应的触发条件。而 Action 就那个管理触发条件的。
Action 类似于 mutation，不同在于：Action 提交的是 mutation，而不是直接变更状态。Action 可以包含任意异步操作。  </p>

<pre><code class="language-js">actions: {  
    increment (context) {
      context.commit('increment')
    }
  }
</code></pre>

<p>Action 函数接受一个与 store 实例具有相同方法和属性的 context 对象，因此你可以调用 context.commit 提交一个 mutation，或者通过 context.state 和 context.getters 来获取 state 和 getters。</p>

<p>实践中，我们会经常会用到 ES2015 的 参数解构 来简化代码（特别是我们需要调用 commit 很多次的时候）</p>

<pre><code class="language-js">actions: {  
  increment ({ commit }) {
    commit('increment')
  }
}
</code></pre>

<p>还记得我们前面说过 mutation 像事件类型吗？因此需要我们给定某个动作来进行触发。而这就是分发 action。Action 通过 store.dispatch 方法触发：</p>

<pre><code class="language-js">store.dispatch('increment')  
</code></pre>

<p>此外，我们还可以在我们可以在 action 内部执行 异步 操作：</p>

<pre><code class="language-js">actions: {  
  incrementAsync ({ commit }) {
    setTimeout(() =&gt; {
      commit('increment')
    }, 1000)
  }
}
</code></pre>

<p>你在组件中使用<code>this.$store.dispatch('xxx')</code> 分发 action，或者使用<code>mapActions</code>辅助函数将组件的 methods 映射为<code>store.dispatch</code>调用（需要先在根节点注入 store ）：</p>

<pre><code class="language-js">import { mapActions } from 'vuex'  
export default {  
  // ...
  methods: {
    ...mapActions([
      'increment' // 映射 this.increment() 为 this.$store.dispatch('increment')
    ]),
    ...mapActions({
      add: 'increment' // 映射 this.add() 为 this.$store.dispatch('increment')
    })
  }
}
</code></pre>

<p>这句话意思其实是，当你使用了 <code>mapActions</code>， 你就不需要再次使用 <code>this.$store.dispatch('xxx')</code>，当你没使用的话，你可以需要手动去分法。
什么时候用大家要根据情况而定的。</p>
            </section>
            <footer class="post-footer">
                        <figure class="author-image">
                            <a class="img" style="background-image: url(https://joe-10005639.cossh.myqcloud.com/jkbb.jpg)"></a>
                        </figure>
                        <h4><span>江矿宝宝.</span></h4>
                    <section class="author">
                            <p>前台端菜, 喜欢钻研新技术.</p>
                        <div class="author-meta">
                            <span class="author-location"><i class="fa fa-map-marker" aria-hidden="true"></i> Nanning, GX</span>
                            <span class="author-link"><i class="fa fa-link" aria-hidden="true"></i> <a href="https://joname1.github.io">https://joname1.github.io</a></span>
                        </div>
                    </section>
                <section class="share">
                    <a href="https://github.com/joname1" target="_blank">
                        <i class="iconfont i-github"></i>
                    </a>
                    <a href="https://twitter.com/im_joname" target="_blank">
                        <i class="iconfont i-twitter"></i>
                    </a>
                    <a href="https://www.zhihu.com/people/joname-liangtan" target="_blank">
                        <i class="iconfont i-zhihu"></i>
                    </a>
                    <a href="mailto:joname.liangtan@gmail.com" target="_blank">
                        <i class="iconfont i-email"></i>
                    </a>
                </section>
                <div id="totop">
                    <a><i class="fa fa-chevron-circle-up" aria-hidden="true"></i></a>
                </div>
            </footer>
        </article>
    </main>


        <footer class="site-footer clearfix">
            <section class="poweredby">2017 &copy; Made with <i class="fa fa-heart"></i> using &lt;ghost/&gt;</section>
        </footer>
    </div>
    <script src="https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/prism/1.6.0/prism.js"></script>    
    <script src="https://cdn.bootcss.com/fitvids/1.1.0/jquery.fitvids.js"></script>
    <script src="../assets/js/index.min.js?v=3fe33f358e"></script>
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?2c150e62328876df1f23bb9dafd9444f";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    
</body>

</html>
